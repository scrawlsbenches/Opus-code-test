{
  "hash": "0656744909c4a5d9e6cb5007e7d02e58b0d2bb32",
  "message": "Add Task #146: Behavioral tests for core user workflows",
  "author": "Claude",
  "timestamp": "2025-12-12 02:00:07 +0000",
  "branch": "claude/multi-index-design-DvifZ",
  "files_changed": [
    "TASK_LIST.md"
  ],
  "insertions": 87,
  "deletions": 1,
  "hunks": [
    {
      "file": "TASK_LIST.md",
      "function": "Active backlog for the Cortical Text Processor project. Completed tasks are arch",
      "start_line": 11,
      "lines_added": [
        "| # | Task | Category | Depends | Effort |",
        "|---|------|----------|---------|--------|",
        "| 146 | Create behavioral tests for core user workflows | Testing | - | Medium |"
      ],
      "lines_removed": [
        "*All high-priority tasks completed!*"
      ],
      "context_before": [
        "## Active Backlog",
        "",
        "<!-- Machine-parseable format for automation -->",
        "",
        "### ðŸ”´ Critical (Do Now)",
        "",
        "*All critical tasks completed!*",
        "",
        "### ðŸŸ  High (Do This Week)",
        ""
      ],
      "context_after": [
        "",
        "### ðŸŸ¡ Medium (Do This Month)",
        "",
        "| # | Task | Category | Depends | Effort |",
        "|---|------|----------|---------|--------|",
        "| 137 | Cap bigram connections to top-K per bigram | Perf | - | Small |",
        "| 138 | Use sparse matrix multiplication for bigram connections | Perf | - | Medium |",
        "| 139 | Batch bigram connection updates to reduce dict overhead | Perf | - | Small |",
        "| 133 | Implement WAL + snapshot persistence (fault-tolerant rebuild) | Arch | 132 | Large |",
        "| 134 | Implement protobuf serialization for corpus | Arch | 132 | Medium |"
      ],
      "change_type": "modify"
    },
    {
      "file": "TASK_LIST.md",
      "function": "TF-IDF embeddings capture semantic similarity much better because terms appearin",
      "start_line": 1467,
      "lines_added": [
        "### 146. Create Behavioral Tests for Core User Workflows",
        "",
        "**Meta:** `status:pending` `priority:high` `category:testing`",
        "**Files:** `tests/test_behavioral.py` (new)",
        "**Effort:** Medium",
        "",
        "**Purpose:** Create acceptance/behavioral tests that verify the system delivers expected",
        "user outcomes. Unlike unit tests (function works correctly) or integration tests",
        "(components work together), behavioral tests verify \"the system feels right to users.\"",
        "",
        "**Why This Matters:**",
        "Dog-fooding revealed issues that unit tests missed:",
        "- Search returning wrong documents for obvious queries",
        "- Python keywords polluting analysis results",
        "- Performance regressions making the system feel slow",
        "",
        "Behavioral tests would have caught these as regressions.",
        "",
        "**Test Categories to Implement:**",
        "",
        "1. **SearchBehavior** - \"Search should feel relevant\"",
        "   ```python",
        "   def test_document_name_matches_rank_highly(self):",
        "       \"\"\"Query matching document name should return that doc in top 2.\"\"\"",
        "       # \"distributed systems\" â†’ distributed_systems in top 2",
        "",
        "   def test_query_expansion_improves_recall(self):",
        "       \"\"\"Expanded queries should find more relevant docs than exact match.\"\"\"",
        "",
        "   def test_code_search_finds_implementations_not_tests(self):",
        "       \"\"\"Code queries should prefer real implementations over test mocks.\"\"\"",
        "   ```",
        "",
        "2. **PerformanceBehavior** - \"System should feel responsive\"",
        "   ```python",
        "   def test_compute_all_under_threshold(self):",
        "       \"\"\"Full analysis should complete within reasonable time.\"\"\"",
        "       # With 109 sample docs: < 20 seconds",
        "",
        "   def test_search_is_fast(self):",
        "       \"\"\"Single query should return quickly.\"\"\"",
        "       # < 100ms per query",
        "   ```",
        "",
        "3. **QualityBehavior** - \"Results should make sense\"",
        "   ```python",
        "   def test_pagerank_surfaces_meaningful_terms(self):",
        "       \"\"\"Top PageRank terms should be domain concepts, not noise.\"\"\"",
        "       # No 'self', 'def', 'assertequal' in top 20",
        "",
        "   def test_clustering_produces_coherent_groups(self):",
        "       \"\"\"Clusters should have good community structure.\"\"\"",
        "       # modularity > 0.3",
        "",
        "   def test_embeddings_capture_semantic_similarity(self):",
        "       \"\"\"Similar terms by embedding should be semantically related.\"\"\"",
        "       # 'learning' similar to 'neural', 'training', 'networks'",
        "   ```",
        "",
        "4. **RobustnessBehavior** - \"System should handle edge cases gracefully\"",
        "   ```python",
        "   def test_empty_query_returns_empty_results(self):",
        "       \"\"\"Empty queries should not crash or return garbage.\"\"\"",
        "",
        "   def test_unknown_terms_handled_gracefully(self):",
        "       \"\"\"Queries with unknown terms should still return results.\"\"\"",
        "   ```",
        "",
        "**Implementation Notes:**",
        "- Use `tests/test_behavioral.py` as a new test file",
        "- Load sample corpus once in `setUpClass` for performance",
        "- Use descriptive assertion messages explaining expected behavior",
        "- Document the \"why\" for each threshold/expectation",
        "",
        "**Acceptance Criteria:**",
        "- [ ] TestSearchBehavior class with 3+ tests",
        "- [ ] TestPerformanceBehavior class with 2+ tests",
        "- [ ] TestQualityBehavior class with 3+ tests",
        "- [ ] TestRobustnessBehavior class with 2+ tests",
        "- [ ] All tests pass on current codebase",
        "- [ ] Tests catch regressions from Tasks #141-145 if reverted",
        "",
        "---",
        ""
      ],
      "lines_removed": [],
      "context_before": [
        "in similar documents are usually semantically related.",
        "",
        "**Acceptance Criteria:**",
        "- [x] 'data' filtered out by CODE_NOISE_TOKENS (Task #141)",
        "- [x] High-frequency terms don't dominate (TF-IDF naturally down-weights)",
        "- [x] Existing good similarities preserved and improved",
        "- [x] New 'tfidf' method available for semantic similarity tasks",
        "",
        "---",
        ""
      ],
      "context_after": [
        "## Category Index",
        "",
        "| Category | Pending | Description |",
        "|----------|---------|-------------|",
        "| Quality | 5 | Quality issues from dog-fooding |",
        "| Perf | 4 | Performance improvements |",
        "| AINav | 6 | AI assistant navigation & usability |",
        "| DevEx | 8 | Developer experience (scripts, tools) |",
        "| Docs | 2 | Documentation improvements |",
        "| Arch | 4 | Architecture refactoring |"
      ],
      "change_type": "add"
    }
  ],
  "hour_of_day": 2,
  "day_of_week": "Friday",
  "seconds_since_last_commit": -301481,
  "is_merge": false,
  "is_initial": false,
  "parent_count": 1,
  "session_id": null,
  "related_chats": [],
  "ci_result": null,
  "reverted": false,
  "amended": false
}