{
  "hash": "ca7e590524aca6a802acd1a41f45dd7ebb1eeca9",
  "message": "Update CLAUDE.md and Claude Skills with new code search capabilities",
  "author": "Claude",
  "timestamp": "2025-12-10 14:49:25 +0000",
  "branch": "claude/multi-index-design-DvifZ",
  "files_changed": [
    ".claude/skills/codebase-search/SKILL.md",
    "CLAUDE.md"
  ],
  "insertions": 69,
  "deletions": 3,
  "hunks": [
    {
      "file": ".claude/skills/codebase-search/SKILL.md",
      "function": "description: Search the Cortical Text Processor codebase using semantic search.",
      "start_line": 4,
      "lines_added": [
        "- **Code concept groups**: Knows \"fetch\", \"get\", \"load\" are synonyms in code context",
        "- **Intent understanding**: Parses \"where do we handle X?\" into location + action + subject",
        "- **Semantic fingerprinting**: Compare and explain code similarity",
        "- **Fast search mode**: ~2-3x faster for large codebases"
      ],
      "lines_removed": [
        "- **Context-aware**: Uses PageRank, TF-IDF, and concept clustering for relevance"
      ],
      "context_before": [
        "allowed-tools: Read, Bash, Glob",
        "---",
        "# Codebase Search Skill",
        "",
        "This skill enables **meaning-based search** over the Cortical Text Processor codebase. It finds relevant code by understanding intent and concepts, not just exact keyword matching.",
        "",
        "## Key Capabilities",
        "",
        "- **Meaning-based retrieval**: Finds related code even when exact words don't match",
        "- **Query expansion**: Automatically includes related terms via co-occurrence and semantic relations"
      ],
      "context_after": [
        "- **No ML required**: Works through graph algorithms on corpus statistics",
        "",
        "## When to Use",
        "",
        "- Finding implementations: \"how does PageRank work\"",
        "- Locating code by intent: \"where do we handle errors\"",
        "- Understanding relationships: \"what connects to the tokenizer\"",
        "- Exploring concepts: \"authentication and validation\"",
        "",
        "## Prerequisites"
      ],
      "change_type": "modify"
    },
    {
      "file": ".claude/skills/codebase-search/SKILL.md",
      "function": "This creates `corpus_dev.pkl` with the indexed codebase.",
      "start_line": 39,
      "lines_added": [
        "| `--fast` | Fast search mode (~2-3x faster, document-level) |",
        "# Natural language intent (parses action + subject)",
        "python scripts/search_codebase.py \"where do we handle authentication\"",
        "",
        "# Code concept synonyms (fetch finds get/load/retrieve too)",
        "python scripts/search_codebase.py \"fetch user data\"",
        "",
        "# Fast mode for quick lookups",
        "python scripts/search_codebase.py \"PageRank\" --fast"
      ],
      "lines_removed": [
        "# Natural language intent",
        "python scripts/search_codebase.py \"how do we compute term relevance\""
      ],
      "context_before": [
        "python scripts/search_codebase.py \"your query here\"",
        "```",
        "",
        "### Options",
        "",
        "| Option | Description |",
        "|--------|-------------|",
        "| `--top N` | Number of results (default: 5) |",
        "| `--verbose` | Show full passage text |",
        "| `--expand` | Show query expansion terms |"
      ],
      "context_after": [
        "| `--interactive` | Interactive search mode |",
        "",
        "### Example Queries",
        "",
        "```bash",
        "# Find by concept (not exact words)",
        "python scripts/search_codebase.py \"graph importance algorithm\"",
        "",
        "",
        "# See what terms the system associates",
        "python scripts/search_codebase.py \"lateral connections\" --expand",
        "",
        "# Interactive exploration",
        "python scripts/search_codebase.py --interactive",
        "```",
        "",
        "## Understanding Results",
        ""
      ],
      "change_type": "modify"
    },
    {
      "file": "CLAUDE.md",
      "function": "def find_documents(",
      "start_line": 230,
      "lines_added": [
        "6. **Use `fast_find_documents()`** for ~2-3x faster search on large corpora",
        "7. **Pre-build index** with `build_search_index()` for fastest repeated queries",
        "",
        "---",
        "",
        "## Code Search Capabilities",
        "",
        "### Code-Aware Tokenization",
        "```python",
        "# Enable identifier splitting for code search",
        "tokenizer = Tokenizer(split_identifiers=True)",
        "tokens = tokenizer.tokenize(\"getUserCredentials\")",
        "# ['getusercredentials', 'get', 'user', 'credentials']",
        "```",
        "",
        "### Programming Concept Expansion",
        "```python",
        "# Expand queries with programming synonyms (get/fetch/load)",
        "results = processor.expand_query(\"fetch data\", use_code_concepts=True)",
        "# Or use the convenience method",
        "results = processor.expand_query_for_code(\"fetch data\")",
        "```",
        "",
        "### Intent-Based Search",
        "```python",
        "# Parse natural language queries",
        "parsed = processor.parse_intent_query(\"where do we handle authentication?\")",
        "# {'intent': 'location', 'action': 'handle', 'subject': 'authentication', ...}",
        "",
        "# Search with intent understanding",
        "results = processor.search_by_intent(\"how do we validate input?\")",
        "```",
        "",
        "### Semantic Fingerprinting",
        "```python",
        "# Compare code similarity",
        "fp1 = processor.get_fingerprint(code_block_1)",
        "fp2 = processor.get_fingerprint(code_block_2)",
        "comparison = processor.compare_fingerprints(fp1, fp2)",
        "explanation = processor.explain_similarity(fp1, fp2)",
        "```",
        "",
        "### Fast Search",
        "```python",
        "# Fast document search (~2-3x faster)",
        "results = processor.fast_find_documents(\"authentication\")",
        "",
        "# Pre-built index for fastest search",
        "index = processor.build_search_index()",
        "results = processor.search_with_index(\"query\", index)",
        "```"
      ],
      "lines_removed": [],
      "context_before": [
        "",
        "---",
        "",
        "## Performance Considerations",
        "",
        "1. **Use `get_by_id()` for ID lookups** - O(1) vs O(n) iteration",
        "2. **Batch document additions** with `add_documents_batch()` for bulk imports",
        "3. **Use incremental updates** with `add_document_incremental()` for live systems",
        "4. **Cache query expansions** when processing multiple similar queries",
        "5. **Pre-compute chunks** in `find_passages_batch()` to avoid redundant work"
      ],
      "context_after": [
        "",
        "---",
        "",
        "## Debugging Tips",
        "",
        "### Inspecting Layer State",
        "```python",
        "processor = CorticalTextProcessor()",
        "processor.process_document(\"test\", \"Neural networks process data.\")",
        "processor.compute_all()"
      ],
      "change_type": "add"
    },
    {
      "file": "CLAUDE.md",
      "function": "for t1, rel, t2, weight in processor.semantic_relations[:10]:",
      "start_line": 276,
      "lines_added": [
        "| Fast search | `processor.fast_find_documents(query)` |",
        "| Code search | `processor.expand_query_for_code(query)` |",
        "| Intent search | `processor.search_by_intent(\"where do we...\")` |",
        "| Fingerprint | `processor.get_fingerprint(text)` |",
        "| Compare | `processor.compare_fingerprints(fp1, fp2)` |"
      ],
      "lines_removed": [],
      "context_before": [
        "",
        "---",
        "",
        "## Quick Reference",
        "",
        "| Task | Command/Method |",
        "|------|----------------|",
        "| Process document | `processor.process_document(id, text)` |",
        "| Build network | `processor.compute_all()` |",
        "| Search | `processor.find_documents_for_query(query)` |"
      ],
      "context_after": [
        "| RAG passages | `processor.find_passages_for_query(query)` |",
        "| Save state | `processor.save(\"corpus.pkl\")` |",
        "| Load state | `processor = CorticalTextProcessor.load(\"corpus.pkl\")` |",
        "| Run tests | `python -m unittest discover -s tests -v` |",
        "| Run showcase | `python showcase.py` |",
        "",
        "---",
        "",
        "## Dog-Fooding: Search the Codebase",
        "",
        "The Cortical Text Processor can index and search its own codebase, providing semantic search capabilities during development."
      ],
      "change_type": "add"
    }
  ],
  "hour_of_day": 14,
  "day_of_week": "Wednesday",
  "seconds_since_last_commit": -428123,
  "is_merge": false,
  "is_initial": false,
  "parent_count": 1,
  "session_id": null,
  "related_chats": [],
  "ci_result": null,
  "reverted": false,
  "amended": false
}