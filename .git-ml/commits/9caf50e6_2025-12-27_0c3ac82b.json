{
  "hash": "9caf50e6e2e1abb80f3c8a8e17567a92576393e6",
  "message": "chore(ml): Track commit data for model training",
  "author": "Claude",
  "timestamp": "2025-12-27 03:02:17 +0000",
  "branch": "claude/accept-handoff-ctrSI",
  "files_changed": [
    ".git-ml/commits/954e52cc_2025-12-27_04dc156e.json",
    ".git-ml/commits/a173e23f_2025-12-27_7887d247.json",
    ".git-ml/tracked/commits.jsonl"
  ],
  "insertions": 247,
  "deletions": 0,
  "hunks": [
    {
      "file": ".git-ml/commits/954e52cc_2025-12-27_04dc156e.json",
      "function": null,
      "start_line": 0,
      "lines_added": [
        "{",
        "  \"hash\": \"954e52cce22166ca14fb9f7dd65842fc2bea680e\",",
        "  \"message\": \"docs(benchmarks): Document corpus generation as Step 1 of pipeline\",",
        "  \"author\": \"Claude\",",
        "  \"timestamp\": \"2025-12-27 03:01:50 +0000\",",
        "  \"branch\": \"claude/accept-handoff-ctrSI\",",
        "  \"files_changed\": [",
        "    \"benchmarks/codebase_slm/generate_corpus.py\"",
        "  ],",
        "  \"insertions\": 21,",
        "  \"deletions\": 0,",
        "  \"hunks\": [",
        "    {",
        "      \"file\": \"benchmarks/codebase_slm/generate_corpus.py\",",
        "      \"function\": null,",
        "      \"start_line\": 1,",
        "      \"lines_added\": [",
        "        \"================================================================================\",",
        "        \"STEP 1 OF TWO-STEP TRAINING PIPELINE\",",
        "        \"================================================================================\",",
        "        \"\",",
        "        \"This script is STEP 1. After running this, run STEP 2 to train:\",",
        "        \"\",",
        "        \"    python -m benchmarks.codebase_slm.generate_corpus --full    # STEP 1 (this)\",",
        "        \"    python -m benchmarks.codebase_slm.train_augmented --dry-run # STEP 2 (train)\",",
        "        \"\",",
        "        \"What it extracts:\",",
        "        \"  - Python files in cortical/    → functions, classes, imports, docstrings\",",
        "        \"  - Markdown files in docs/      → sections, Q&A pairs, definitions\",",
        "        \"  - Markdown files in samples/   → knowledge-base entries, memories\",",
        "        \"  - GoT entities in .got/        → tasks, decisions, metadata\",",
        "        \"\",",
        "        \"Output:\",",
        "        \"  - corpus/training_patterns.jsonl  (~35,000 patterns)\",",
        "        \"  - This file is gitignored - regenerate after codebase changes!\",",
        "        \"\",",
        "        \"\",",
        "        \"See train_augmented.py docstring for the full pipeline documentation.\"",
        "      ],",
        "      \"lines_removed\": [],",
        "      \"context_before\": [",
        "        \"#!/usr/bin/env python3\",",
        "        \"\\\"\\\"\\\"\",",
        "        \"Generate training corpus for Repository-Native SLM.\",",
        "        \"\"",
        "      ],",
        "      \"context_after\": [",
        "        \"This script orchestrates the extraction and pattern generation pipeline\",",
        "        \"with batching, progress reporting, and timeout protection.\",",
        "        \"\",",
        "        \"Usage:\",",
        "        \"    # Quick test (5 files each)\",",
        "        \"    python -m benchmarks.codebase_slm.generate_corpus --quick\",",
        "        \"\",",
        "        \"    # Full generation\",",
        "        \"    python -m benchmarks.codebase_slm.generate_corpus --full\",",
        "        \"\",",
        "        \"    # Resume from cache\",",
        "        \"    python -m benchmarks.codebase_slm.generate_corpus --resume\",",
        "        \"\\\"\\\"\\\"\",",
        "        \"\",",
        "        \"import argparse\",",
        "        \"import sys\",",
        "        \"import time\",",
        "        \"from pathlib import Path\",",
        "        \"from datetime import datetime\",",
        "        \"\",",
        "        \"# Add project root to path\",",
        "        \"sys.path.insert(0, str(Path(__file__).parent.parent.parent))\"",
        "      ],",
        "      \"change_type\": \"add\"",
        "    }",
        "  ],",
        "  \"hour_of_day\": 3,",
        "  \"day_of_week\": \"Saturday\",",
        "  \"seconds_since_last_commit\": 48,",
        "  \"is_merge\": false,",
        "  \"is_initial\": false,",
        "  \"parent_count\": 1,",
        "  \"session_id\": \"c7e7f25e\",",
        "  \"related_chats\": [",
        "    \"chat-20251227-015100-015a56\"",
        "  ],",
        "  \"ci_result\": null,",
        "  \"reverted\": false,",
        "  \"amended\": false",
        "}"
      ],
      "lines_removed": [],
      "context_before": [],
      "context_after": [],
      "change_type": "add"
    },
    {
      "file": ".git-ml/commits/a173e23f_2025-12-27_7887d247.json",
      "function": null,
      "start_line": 0,
      "lines_added": [
        "{",
        "  \"hash\": \"a173e23f2309cb08ab3c2c7cd3552c909fc08862\",",
        "  \"message\": \"docs(benchmarks): Add comprehensive training pipeline documentation\",",
        "  \"author\": \"Claude\",",
        "  \"timestamp\": \"2025-12-27 03:01:02 +0000\",",
        "  \"branch\": \"claude/accept-handoff-ctrSI\",",
        "  \"files_changed\": [",
        "    \"benchmarks/codebase_slm/train_augmented.py\"",
        "  ],",
        "  \"insertions\": 89,",
        "  \"deletions\": 11,",
        "  \"hunks\": [",
        "    {",
        "      \"file\": \"benchmarks/codebase_slm/train_augmented.py\",",
        "      \"function\": null,",
        "      \"start_line\": 1,",
        "      \"lines_added\": [",
        "        \"================================================================================\",",
        "        \"TRAINING PIPELINE OVERVIEW\",",
        "        \"================================================================================\",",
        "        \"This script is STEP 2 of a two-step process:\",",
        "        \"  STEP 1: Generate corpus from codebase (REQUIRED FIRST!)\",",
        "        \"  --------------------------------------------------------\",",
        "        \"  python -m benchmarks.codebase_slm.generate_corpus --full\",",
        "        \"  This extracts training patterns from:\",",
        "        \"    - 149 Python files in cortical/ → functions, classes, imports\",",
        "        \"    - 254 Markdown files in docs/ + samples/ → sections, Q&A pairs\",",
        "        \"    - GoT entities → tasks, decisions, metadata\",",
        "        \"  Output: corpus/training_patterns.jsonl (~35,000 patterns)\",",
        "        \"\",",
        "        \"\",",
        "        \"  STEP 2: Train model (THIS SCRIPT)\",",
        "        \"  ----------------------------------\",",
        "        \"  python -m benchmarks.codebase_slm.train_augmented --dry-run\",",
        "        \"\",",
        "        \"  This combines:\",",
        "        \"    - corpus/training_patterns.jsonl (~35,000 patterns) ← from Step 1\",",
        "        \"    - data/augmented_corpus.txt (~2,000 lines) ← curated definitions\",",
        "        \"\",",
        "        \"  Output: models/prism_augmented.json (~13MB, 37K docs, 15K vocab)\",",
        "        \"\",",
        "        \"\",",
        "        \"================================================================================\",",
        "        \"WHAT WENT WRONG (Dec 27, 2025 Incident)\",",
        "        \"================================================================================\",",
        "        \"\",",
        "        \"An agent ran this script WITHOUT running generate_corpus.py first:\",",
        "        \"  - corpus/training_patterns.jsonl didn't exist (gitignored, not tracked)\",",
        "        \"  - Script printed \\\"No existing patterns found\\\" and continued\",",
        "        \"  - Trained on only 2,094 lines instead of 37,676\",",
        "        \"  - Result: 329 vocab model replaced 15,814 vocab model (98% loss!)\",",
        "        \"\",",
        "        \"The model was restored from git, and this warning was added.\",",
        "        \"\",",
        "        \"See: samples/memories/2025-12-27-knowledge-transfer-prism-model-incident.md\",",
        "        \"\",",
        "        \"\",",
        "        \"================================================================================\",",
        "        \"DATA SOURCES\",",
        "        \"================================================================================\",",
        "        \"\",",
        "        \"1. corpus/training_patterns.jsonl (GENERATED, gitignored)\",",
        "        \"   - Created by: generate_corpus.py --full\",",
        "        \"   - Contains: ~35,000 Q&A and completion patterns\",",
        "        \"   - Format: {\\\"pattern_type\\\": \\\"qa\\\", \\\"input_text\\\": \\\"...\\\", \\\"target_text\\\": \\\"...\\\"}\",",
        "        \"   - MUST BE REGENERATED after codebase changes\",",
        "        \"\",",
        "        \"2. data/augmented_corpus.txt (TRACKED in git)\",",
        "        \"   - Contains: ~2,000 curated concept definitions\",",
        "        \"   - Format: Plain text, one pattern per line\",",
        "        \"   - Example: \\\"PageRank is a graph algorithm for computing node importance\\\"\",",
        "        \"\",",
        "        \"3. samples/knowledge-base/*.md (TRACKED in git)\",",
        "        \"   - Contains: 3,144 lines of curated Q&A pairs\",",
        "        \"   - Used by generate_corpus.py to create patterns\",",
        "        \"\",",
        "        \"\",",
        "        \"================================================================================\",",
        "        \"USAGE\",",
        "        \"================================================================================\",",
        "        \"\",",
        "        \"# ALWAYS run generate_corpus.py first!\",",
        "        \"python -m benchmarks.codebase_slm.generate_corpus --full\",",
        "        \"\",",
        "        \"# Then train with dry-run to verify (RECOMMENDED)\",",
        "        \"python -m benchmarks.codebase_slm.train_augmented --dry-run\",",
        "        \"\",",
        "        \"# Save to custom path (safest)\",",
        "        \"python -m benchmarks.codebase_slm.train_augmented --output models/my_model.json\",",
        "        \"\",",
        "        \"# Save to default path (creates timestamped backup first)\",",
        "        \"python -m benchmarks.codebase_slm.train_augmented\",",
        "        \"\",",
        "        \"# Force overwrite without backup (use with caution!)\",",
        "        \"python -m benchmarks.codebase_slm.train_augmented --force\",",
        "        \"\",",
        "        \"\",",
        "        \"================================================================================\",",
        "        \"SAFEGUARDS\",",
        "        \"================================================================================\",",
        "        \"\",",
        "        \"1. --dry-run: Evaluate without saving anything\",",
        "        \"2. --output: Explicit path prevents accidental overwrites\",",
        "        \"3. Auto-backup: Creates models/backups/prism_augmented_TIMESTAMP.json\",",
        "        \"4. Provenance: Saves corpus hash and metadata in model's _provenance field\",",
        "        \"5. Loud warning: Shows error if corpus/training_patterns.jsonl is missing\"",
        "      ],",
        "      \"lines_removed\": [",
        "        \"IMPORTANT: This script saves models to disk. Use --dry-run to evaluate\",",
        "        \"without saving, or --output to specify a custom output path.\",",
        "        \"Usage:\",",
        "        \"    # Dry run (evaluate only, no save)\",",
        "        \"    python -m benchmarks.codebase_slm.train_augmented --dry-run\",",
        "        \"    # Save to custom path (recommended)\",",
        "        \"    python -m benchmarks.codebase_slm.train_augmented --output models/my_model.json\",",
        "        \"    # Save to default path (creates backup first)\",",
        "        \"    python -m benchmarks.codebase_slm.train_augmented\",",
        "        \"    # Force overwrite without backup\",",
        "        \"    python -m benchmarks.codebase_slm.train_augmented --force\"",
        "      ],",
        "      \"context_before\": [",
        "        \"#!/usr/bin/env python3\",",
        "        \"\\\"\\\"\\\"\",",
        "        \"Train PRISM-SLM with augmented corpus and run benchmarks.\",",
        "        \"\"",
        "      ],",
        "      \"context_after\": [",
        "        \"\",",
        "        \"\",",
        "        \"\",",
        "        \"\",",
        "        \"\\\"\\\"\\\"\",",
        "        \"\",",
        "        \"import argparse\",",
        "        \"import hashlib\",",
        "        \"import json\",",
        "        \"import shutil\",",
        "        \"import sys\",",
        "        \"from datetime import datetime\",",
        "        \"from pathlib import Path\"",
        "      ],",
        "      \"change_type\": \"modify\"",
        "    }",
        "  ],",
        "  \"hour_of_day\": 3,",
        "  \"day_of_week\": \"Saturday\",",
        "  \"seconds_since_last_commit\": 200,",
        "  \"is_merge\": false,",
        "  \"is_initial\": false,",
        "  \"parent_count\": 1,",
        "  \"session_id\": \"c7e7f25e\",",
        "  \"related_chats\": [",
        "    \"chat-20251227-015100-015a56\"",
        "  ],",
        "  \"ci_result\": null,",
        "  \"reverted\": false,",
        "  \"amended\": false",
        "}"
      ],
      "lines_removed": [],
      "context_before": [],
      "context_after": [],
      "change_type": "add"
    },
    {
      "file": ".git-ml/tracked/commits.jsonl",
      "function": null,
      "start_line": 2400,
      "lines_added": [
        "{\"hash\":\"a173e23f2309cb08ab3c2c7cd3552c909fc08862\",\"message\":\"docs(benchmarks): Add comprehensive training pipeline documentation\",\"author\":\"Claude\",\"timestamp\":\"2025-12-27 03:01:02 +0000\",\"branch\":\"claude/accept-handoff-ctrSI\",\"files_changed\":[\"benchmarks/codebase_slm/train_augmented.py\"],\"insertions\":89,\"deletions\":11,\"hour_of_day\":3,\"day_of_week\":\"Saturday\",\"is_merge\":false,\"is_initial\":false,\"parent_count\":1,\"seconds_since_last_commit\":200,\"session_id\":\"c7e7f25e\"}",
        "{\"hash\":\"954e52cce22166ca14fb9f7dd65842fc2bea680e\",\"message\":\"docs(benchmarks): Document corpus generation as Step 1 of pipeline\",\"author\":\"Claude\",\"timestamp\":\"2025-12-27 03:01:50 +0000\",\"branch\":\"claude/accept-handoff-ctrSI\",\"files_changed\":[\"benchmarks/codebase_slm/generate_corpus.py\"],\"insertions\":21,\"deletions\":0,\"hour_of_day\":3,\"day_of_week\":\"Saturday\",\"is_merge\":false,\"is_initial\":false,\"parent_count\":1,\"seconds_since_last_commit\":48,\"session_id\":\"c7e7f25e\"}"
      ],
      "lines_removed": [],
      "context_before": [
        "{\"hash\": \"299931021db7ef3186850c377a189235aa784906\", \"message\": \"refactor(tests): Reorganize tests by category and mark slow tests\", \"author\": \"Claude\", \"timestamp\": \"2025-12-26 20:30:13 +0000\", \"branch\": \"claude/profile-unit-tests-WUbZi\", \"files_changed\": [\"docs/unit-test-profiling-analysis.md\", \"tests/integration/test_prism_slm_integration.py\", \"tests/integration/test_process_lock_integration.py\", \"tests/performance/test_got_query_perf.py\", \"tests/unit/got/test_query_builder.py\", \"tests/unit/got/test_stale_lock_recovery.py\", \"tests/unit/test_consolidation.py\", \"tests/unit/test_graph_persistence.py\", \"tests/unit/test_prism_slm.py\", \"tests/unit/test_process_lock.py\", \"tests/unit/test_utils_locking.py\"], \"insertions\": 195, \"deletions\": 123, \"hour_of_day\": 20, \"day_of_week\": \"Friday\", \"is_merge\": false, \"is_initial\": false, \"parent_count\": 1, \"seconds_since_last_commit\": -8376}",
        "{\"hash\": \"faca195f735773a5653e709d29c295f5e30a74bb\", \"message\": \"chore: Add ML tracked directory to .gitignore exceptions\", \"author\": \"Claude\", \"timestamp\": \"2025-12-27 01:09:10 +0000\", \"branch\": \"claude/profile-unit-tests-WUbZi\", \"files_changed\": [\".gitignore\"], \"insertions\": 4, \"deletions\": 0, \"hour_of_day\": 1, \"day_of_week\": \"Saturday\", \"is_merge\": false, \"is_initial\": false, \"parent_count\": 1, \"seconds_since_last_commit\": 8361}",
        "{\"hash\":\"HEAD\",\"message\":\"fix(benchmarks): Add safeguards to prevent accidental model overwrites\",\"author\":\"Claude\",\"timestamp\":\"2025-12-27 02:08:07 +0000\",\"branch\":\"claude/accept-handoff-ctrSI\",\"files_changed\":[\"benchmarks/codebase_slm/train_augmented.py\",\"benchmarks/codebase_slm/train_slm.py\"],\"insertions\":275,\"deletions\":23,\"hour_of_day\":2,\"day_of_week\":\"Saturday\",\"is_merge\":false,\"is_initial\":false,\"parent_count\":1,\"seconds_since_last_commit\":677,\"session_id\":\"c7e7f25e\"}",
        "{\"hash\":\"945cd340fe4033a8d96ca062de277409e9b09a07\",\"message\":\"fix(benchmarks): Add safeguards to prevent accidental model overwrites\",\"author\":\"Claude\",\"timestamp\":\"2025-12-27 02:08:07 +0000\",\"branch\":\"claude/accept-handoff-ctrSI\",\"files_changed\":[\"benchmarks/codebase_slm/train_augmented.py\",\"benchmarks/codebase_slm/train_slm.py\"],\"insertions\":275,\"deletions\":23,\"hour_of_day\":2,\"day_of_week\":\"Saturday\",\"is_merge\":false,\"is_initial\":false,\"parent_count\":1,\"seconds_since_last_commit\":677,\"session_id\":\"c7e7f25e\"}",
        "{\"hash\":\"b13044b88739516a22f844715c88d956c4992dfe\",\"message\":\"fix(ml): Configure Claude Code hooks and fix commit command\",\"author\":\"Claude\",\"timestamp\":\"2025-12-27 02:20:49 +0000\",\"branch\":\"claude/accept-handoff-ctrSI\",\"files_changed\":[\".claude/settings.local.json\",\"scripts/ml_data_collector.py\"],\"insertions\":24,\"deletions\":0,\"hour_of_day\":2,\"day_of_week\":\"Saturday\",\"is_merge\":false,\"is_initial\":false,\"parent_count\":1,\"seconds_since_last_commit\":762,\"session_id\":\"c7e7f25e\"}",
        "{\"hash\":\"9f5413fae0460d2ad29b0058ca5c9204633dd947\",\"message\":\"fix(gitignore): Add PRISM model backups directory to ignore list\",\"author\":\"Claude\",\"timestamp\":\"2025-12-27 02:29:03 +0000\",\"branch\":\"claude/accept-handoff-ctrSI\",\"files_changed\":[\".gitignore\"],\"insertions\":4,\"deletions\":0,\"hour_of_day\":2,\"day_of_week\":\"Saturday\",\"is_merge\":false,\"is_initial\":false,\"parent_count\":1,\"seconds_since_last_commit\":484,\"session_id\":\"c7e7f25e\"}",
        "{\"hash\":\"3432f3641f2929b1c592850fce0c29978a55179b\",\"message\":\"fix(gitignore): Track ML training data (commits, chats, sessions, actions)\",\"author\":\"Claude\",\"timestamp\":\"2025-12-27 02:32:42 +0000\",\"branch\":\"claude/accept-handoff-ctrSI\",\"files_changed\":[\".git-ml/commits/945cd340_2025-12-27_109bdefd.json\",\".git-ml/commits/9f5413fa_2025-12-27_9579401d.json\",\".git-ml/commits/HEAD_2025-12-27_039011da.json\",\".git-ml/commits/b13044b8_2025-12-27_8455cd84.json\",\".gitignore\"],\"insertions\":1450,\"deletions\":14,\"hour_of_day\":2,\"day_of_week\":\"Saturday\",\"is_merge\":false,\"is_initial\":false,\"parent_count\":1,\"seconds_since_last_commit\":209,\"session_id\":\"c7e7f25e\"}",
        "{\"hash\":\"7a52da64995e15fbc7186712a86940bbe2ffdcad\",\"message\":\"docs: Add knowledge transfer for PRISM model overwrite incident\",\"author\":\"Claude\",\"timestamp\":\"2025-12-27 02:44:56 +0000\",\"branch\":\"claude/accept-handoff-ctrSI\",\"files_changed\":[\"samples/memories/2025-12-27-knowledge-transfer-prism-model-incident.md\"],\"insertions\":218,\"deletions\":0,\"hour_of_day\":2,\"day_of_week\":\"Saturday\",\"is_merge\":false,\"is_initial\":false,\"parent_count\":1,\"seconds_since_last_commit\":724,\"session_id\":\"c7e7f25e\"}",
        "{\"hash\":\"91fc250ef04b0343ddd694a0c0d44e718c66489e\",\"message\":\"docs: Add forensic analysis to PRISM incident knowledge transfer\",\"author\":\"Claude\",\"timestamp\":\"2025-12-27 02:51:46 +0000\",\"branch\":\"claude/accept-handoff-ctrSI\",\"files_changed\":[\"samples/memories/2025-12-27-knowledge-transfer-prism-model-incident.md\"],\"insertions\":61,\"deletions\":15,\"hour_of_day\":2,\"day_of_week\":\"Saturday\",\"is_merge\":false,\"is_initial\":false,\"parent_count\":1,\"seconds_since_last_commit\":397,\"session_id\":\"c7e7f25e\"}",
        "{\"hash\":\"7a636d341d1ec4a1664d0c1d634f8ef4f3df3ce5\",\"message\":\"fix(benchmarks): Add loud warning when training corpus is missing\",\"author\":\"Claude\",\"timestamp\":\"2025-12-27 02:57:31 +0000\",\"branch\":\"claude/accept-handoff-ctrSI\",\"files_changed\":[\"benchmarks/codebase_slm/train_augmented.py\",\"samples/memories/2025-12-27-knowledge-transfer-prism-model-incident.md\"],\"insertions\":60,\"deletions\":41,\"hour_of_day\":2,\"day_of_week\":\"Saturday\",\"is_merge\":false,\"is_initial\":false,\"parent_count\":1,\"seconds_since_last_commit\":335,\"session_id\":\"c7e7f25e\"}"
      ],
      "context_after": [],
      "change_type": "add"
    }
  ],
  "hour_of_day": 3,
  "day_of_week": "Saturday",
  "seconds_since_last_commit": 27,
  "is_merge": false,
  "is_initial": false,
  "parent_count": 1,
  "session_id": "c7e7f25e",
  "related_chats": [
    "chat-20251227-015100-015a56"
  ],
  "ci_result": null,
  "reverted": false,
  "amended": false
}