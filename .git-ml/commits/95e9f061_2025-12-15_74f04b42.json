{
  "hash": "95e9f0613519825657af2f521e5c8512a9046d89",
  "message": "fix: Increase ML data retention to 2 years for training milestones",
  "author": "Claude",
  "timestamp": "2025-12-15 14:04:23 +0000",
  "branch": "claude/multi-index-design-DvifZ",
  "files_changed": [
    "README.md",
    "scripts/ml_data_collector.py"
  ],
  "insertions": 7,
  "deletions": 5,
  "hunks": [
    {
      "file": "README.md",
      "function": "When disabled, no data is written to `.git-ml/`. You can still use all other fea",
      "start_line": 554,
      "lines_added": [
        "**Data Retention:** Old data is kept for 2 years (enough to hit training milestones):",
        "# Preview what would be deleted (730 days default)",
        "# Manually clean up older data if needed",
        "python scripts/ml_data_collector.py cleanup --days 365"
      ],
      "lines_removed": [
        "**Data Retention:** Old data is automatically cleaned up:",
        "# Preview what would be deleted (90 days default)",
        "# Clean up data older than 60 days",
        "python scripts/ml_data_collector.py cleanup --days 60"
      ],
      "context_before": [
        "- Passwords and credentials",
        "- Private keys (RSA, SSH, etc.)",
        "- Database connection strings",
        "- GitHub/Slack tokens, JWTs",
        "",
        "```bash",
        "# Test what gets redacted",
        "python scripts/ml_data_collector.py redact-test --text \"api_key=sk-abc123secret\"",
        "```",
        ""
      ],
      "context_after": [
        "```bash",
        "python scripts/ml_data_collector.py cleanup --dry-run",
        "",
        "```",
        "",
        "**Privacy Guarantees:**",
        "- **Local storage only**: Data never leaves your machine automatically",
        "- **Gitignored**: `.git-ml/` is excluded from version control",
        "- **Regeneratable**: All commit data can be backfilled from git history",
        "- **Full control**: Delete `.git-ml/` anytime to remove all collected data",
        "- **Transparent**: All collection code is in `scripts/ml_data_collector.py`",
        "",
        "### Contributing Your Data"
      ],
      "change_type": "modify"
    },
    {
      "file": "scripts/ml_data_collector.py",
      "function": "CHAT_SCHEMA = {",
      "start_line": 125,
      "lines_added": [
        "# 2 years - enough time to hit training milestones at typical dev pace",
        "# (~66 commits/active day observed, need 5000 for code suggestions)",
        "DEFAULT_RETENTION_DAYS = 730"
      ],
      "lines_removed": [
        "DEFAULT_RETENTION_DAYS = 90"
      ],
      "context_before": [
        "",
        "ACTION_SCHEMA = {",
        "    \"required\": [\"id\", \"timestamp\", \"session_id\", \"action_type\", \"target\"],",
        "    \"types\": {",
        "        \"id\": str, \"timestamp\": str, \"session_id\": str,",
        "        \"action_type\": str, \"target\": str, \"success\": bool,",
        "    }",
        "}",
        "",
        "# Data retention configuration (days)"
      ],
      "context_after": [
        "CONSENT_FILE = ML_DATA_DIR / \"contribution_consent.json\"",
        "",
        "# Sensitive data patterns to redact before storage",
        "# These patterns are applied to query/response text before saving",
        "REDACTION_PATTERNS = [",
        "    # API keys and tokens",
        "    (r'(?i)(api[_-]?key|apikey|api_secret|secret[_-]?key)\\s*[=:]\\s*[\"\\']?[\\w\\-]{20,}[\"\\']?', r'\\1=<REDACTED>'),",
        "    (r'(?i)(token|bearer|authorization)\\s*[=:]\\s*[\"\\']?[\\w\\-\\.]{20,}[\"\\']?', r'\\1=<REDACTED>'),",
        "    # Passwords and secrets",
        "    (r'(?i)(password|passwd|pwd|secret)\\s*[=:]\\s*[\"\\']?[^\\s\"\\']{8,}[\"\\']?', r'\\1=<REDACTED>'),"
      ],
      "change_type": "modify"
    }
  ],
  "hour_of_day": 14,
  "day_of_week": "Monday",
  "seconds_since_last_commit": 589,
  "is_merge": false,
  "is_initial": false,
  "parent_count": 1,
  "session_id": null,
  "related_chats": [],
  "ci_result": null,
  "reverted": false,
  "amended": false
}