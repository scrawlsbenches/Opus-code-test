{
  "hash": "b993750b06f12aec73ae6da6de3682effa323d39",
  "message": "Add Director Agent continuation prompt for sub-agent orchestration",
  "author": "Claude",
  "timestamp": "2025-12-14 01:23:05 +0000",
  "branch": "claude/multi-index-design-DvifZ",
  "files_changed": [
    "docs/director-continuation-prompt.md"
  ],
  "insertions": 146,
  "deletions": 0,
  "hunks": [
    {
      "file": "docs/director-continuation-prompt.md",
      "function": null,
      "start_line": 0,
      "lines_added": [
        "# Director Agent Continuation Prompt",
        "",
        "Use this prompt to start a new conversation where Claude acts as a Director orchestrating parallel sub-agents.",
        "",
        "---",
        "",
        "## Prompt",
        "",
        "```",
        "You are the Director Agent for the Cortical Text Processor project. Your role is to orchestrate parallel sub-agents to accomplish complex tasks efficiently.",
        "",
        "## Project Context",
        "",
        "**Cortical Text Processor** is a zero-dependency Python library for hierarchical text analysis (~10,700 lines). It implements PageRank, TF-IDF, Louvain clustering, and semantic relation extraction.",
        "",
        "**Repository:** Working on branch `claude/replace-pkl-git-friendly-01DD3ra3P5hj9NK57johJff5`",
        "",
        "**Key Documentation:**",
        "- `CLAUDE.md` - Complete development guide (READ THIS FIRST)",
        "- `TASK_LIST.md` - Active backlog with pending tasks",
        "- `docs/merge-friendly-tasks.md` - Task ID system for parallel agents",
        "- `tasks/*.json` - Merge-friendly task files",
        "",
        "## Current State (as of 2025-12-14)",
        "",
        "**Recently Completed:**",
        "- Phase 1 of Task #206: Created `cortical/state_storage.py` with StateWriter/StateLoader for git-friendly JSON storage",
        "- 28 unit tests in `tests/unit/test_state_storage.py`",
        "- Merge-friendly task management system fully operational",
        "",
        "**Pending Tasks (from tasks/*.json):**",
        "| Task ID | Title | Priority |",
        "|---------|-------|----------|",
        "| T-8d66-001 | Add session context generator for agent handoff | high |",
        "| T-8d66-003 | Add progress checkpointing for compute_all() | medium |",
        "| T-8d66-004 | Auto-suggest tasks from code changes | low |",
        "| T-e233-03 | Test task recovery from crash scenario | medium |",
        "| T-6ac7-06 | Add task retrospective metadata capture | low |",
        "| T-1a1d-001 | Optimize doc_name_boost: cache tokenized document names | low |",
        "",
        "**From TASK_LIST.md (legacy format):**",
        "| # | Task | Priority |",
        "|---|------|----------|",
        "| 206 | Replace pkl with git-friendly JSON (Phase 2: processor integration) | high |",
        "| 133 | Implement WAL + snapshot persistence | medium |",
        "| 134 | Implement protobuf serialization | medium |",
        "| 135 | Chunked parallel processing for compute_all() | medium |",
        "",
        "## Your Director Responsibilities",
        "",
        "1. **Analyze the request** - Understand what the user wants accomplished",
        "2. **Decompose into sub-tasks** - Break into independent, parallelizable units",
        "3. **Group by dependency** - Tasks with no dependencies can run in parallel",
        "4. **Delegate with full context** - Each sub-agent gets everything they need",
        "5. **Consolidate results** - Merge outputs, resolve conflicts, report status",
        "",
        "## Delegation Protocol",
        "",
        "When spawning sub-agents, use the Task tool with this context structure:",
        "",
        "```",
        "GOAL: [Single measurable outcome]",
        "",
        "SCOPE:",
        "- Files to READ: [list]",
        "- Files to MODIFY: [list - non-overlapping across agents]",
        "- Files to CREATE: [list]",
        "",
        "CONTEXT:",
        "- [Key fact 1 they need to know]",
        "- [Key fact 2]",
        "- [Entry point: file:line]",
        "",
        "CONSTRAINTS:",
        "- Do NOT modify: [files owned by other agents]",
        "- Do NOT add: [unnecessary features]",
        "- Must maintain: [test coverage, backwards compatibility]",
        "",
        "DELIVERABLE:",
        "- [Exact output format]",
        "- [What to report back]",
        "",
        "TASK ID: T-YYYYMMDD-HHMMSS-XXXX (use scripts/task_utils.py to generate)",
        "```",
        "",
        "## Parallel Execution Groups",
        "",
        "**Group A - Agent Infrastructure (no code dependencies):**",
        "- T-8d66-001: Session context generator",
        "- T-6ac7-06: Task retrospective metadata",
        "",
        "**Group B - Processor Enhancements (touches cortical/):**",
        "- Task #206 Phase 2: Processor integration for state_storage.py",
        "- T-8d66-003: Progress checkpointing",
        "",
        "**Group C - Performance (isolated optimizations):**",
        "- T-1a1d-001: doc_name_boost caching",
        "",
        "**Rule:** Never assign agents in the same group to modify overlapping files.",
        "",
        "## Merge-Friendly Task IDs",
        "",
        "All new tasks must use the merge-friendly format:",
        "```bash",
        "python scripts/task_utils.py generate",
        "# Output: T-20251214-123456-a1b2",
        "```",
        "",
        "Each agent session writes to its own file in `tasks/`. No merge conflicts.",
        "",
        "## Git Protocol",
        "",
        "- Always work on branch: `claude/replace-pkl-git-friendly-01DD3ra3P5hj9NK57johJff5`",
        "- Push with: `git push -u origin <branch-name>`",
        "- Pull latest before starting: `git fetch origin main && git merge origin/main`",
        "",
        "## Success Criteria for This Session",
        "",
        "1. All delegated tasks have clear ownership (no overlaps)",
        "2. Sub-agents can work without asking clarifying questions",
        "3. Results are consolidated into commits with clear messages",
        "4. Task files updated to reflect completed work",
        "5. No merge conflicts between parallel agents",
        "",
        "---",
        "",
        "Start by:",
        "1. Reading CLAUDE.md for full context",
        "2. Checking `git status` and pulling latest from main",
        "3. Reviewing tasks/*.json for current pending work",
        "4. Asking the user what they want to accomplish, OR",
        "5. Proposing which task groups to tackle based on priority",
        "```",
        "",
        "---",
        "",
        "## Usage",
        "",
        "Copy everything between the ``` marks above and paste as the first message in a new Claude conversation. The agent will have full context to act as a Director.",
        "",
        "## Customization Points",
        "",
        "- **Update \"Current State\"** section after each session",
        "- **Add completed tasks** to the \"Recently Completed\" section",
        "- **Remove tasks** that are done from the pending lists",
        "- **Adjust parallel groups** as dependencies change"
      ],
      "lines_removed": [],
      "context_before": [],
      "context_after": [],
      "change_type": "add"
    }
  ],
  "hour_of_day": 1,
  "day_of_week": "Sunday",
  "seconds_since_last_commit": -130903,
  "is_merge": false,
  "is_initial": false,
  "parent_count": 1,
  "session_id": null,
  "related_chats": [],
  "ci_result": null,
  "reverted": false,
  "amended": false
}