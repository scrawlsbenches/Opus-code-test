{
  "hash": "6cb35d68f2da791d0adc53f74158eda5bd08b904",
  "message": "Add critical task #122: Investigate Concept Layer & Embeddings regressions",
  "author": "Claude",
  "timestamp": "2025-12-11 13:33:40 +0000",
  "branch": "claude/multi-index-design-DvifZ",
  "files_changed": [
    "TASK_LIST.md"
  ],
  "insertions": 73,
  "deletions": 2,
  "hunks": [
    {
      "file": "TASK_LIST.md",
      "function": null,
      "start_line": 1,
      "lines_added": [
        "**Pending Tasks:** 26",
        "| # | Task | Category | Depends | Effort |",
        "|---|------|----------|---------|--------|",
        "| 122 | Investigate Concept Layer & Embeddings regressions | BugFix | - | Medium |"
      ],
      "lines_removed": [
        "**Pending Tasks:** 25",
        "*No critical tasks - all blockers resolved!*"
      ],
      "context_before": [
        "# Task List: Cortical Text Processor",
        "",
        "Active backlog for the Cortical Text Processor project. Completed tasks are archived in [TASK_ARCHIVE.md](TASK_ARCHIVE.md).",
        "",
        "**Last Updated:** 2025-12-11"
      ],
      "context_after": [
        "**Completed Tasks:** 85+ (see archive)",
        "",
        "---",
        "",
        "## Active Backlog",
        "",
        "<!-- Machine-parseable format for automation -->",
        "",
        "### ðŸ”´ Critical (Do Now)",
        "",
        "",
        "### ðŸŸ  High (Do This Week)",
        "",
        "| # | Task | Category | Depends | Effort |",
        "|---|------|----------|---------|--------|",
        "| 94 | Split query.py into focused modules | Arch | - | Large |",
        "| 97 | Integrate CorticalConfig into processor | Arch | - | Medium |",
        "",
        "### ðŸŸ¡ Medium (Do This Month)",
        ""
      ],
      "change_type": "modify"
    },
    {
      "file": "TASK_LIST.md",
      "function": "dependencies:",
      "start_line": 875,
      "lines_added": [
        "### 122. Investigate Concept Layer & Embeddings Regressions",
        "",
        "**Meta:** `status:pending` `priority:critical` `category:bugfix`",
        "**Files:** `cortical/analysis.py`, `cortical/embeddings.py`, `showcase.py`",
        "**Effort:** Medium",
        "",
        "**Problem:** Showcase output reveals potential regressions or bugs:",
        "",
        "1. **Concept Layer has only 3 clusters** for 95 documents",
        "   - Expected: 10-20+ concept clusters for diverse corpus",
        "   - Current: Only 3 minicolumns in Layer 2",
        "   - This severely limits semantic grouping capability",
        "",
        "2. **Graph embeddings show nonsensical similarities**",
        "   - \"neural\" shows 0.868 similarity to \"blockchain\", \"consensus\", \"uniformly\"",
        "   - Expected: \"neural\" should be most similar to \"networks\", \"learning\", \"artificial\"",
        "   - Suggests embedding algorithm may be broken or misconfigured",
        "",
        "**Investigation Steps:**",
        "",
        "1. **Git history analysis:**",
        "   ```bash",
        "   # Find when concept clustering changed",
        "   git log --oneline -p -- cortical/analysis.py | grep -A5 -B5 \"build_concept_clusters\\|label_propagation\"",
        "",
        "   # Find when embeddings changed",
        "   git log --oneline -p -- cortical/embeddings.py | grep -A5 -B5 \"compute_graph_embeddings\"",
        "",
        "   # Check for recent changes to showcase",
        "   git log --oneline -20 -- showcase.py",
        "   ```",
        "",
        "2. **Verify expected behavior:**",
        "   - Check if `cluster_strictness` parameter is being applied correctly",
        "   - Verify embedding method (adjacency vs spectral vs random_walk)",
        "   - Compare current output with any baseline metrics",
        "",
        "3. **Reproduce issue:**",
        "   ```python",
        "   processor.compute_all(verbose=True)",
        "   print(f\"Concept clusters: {processor.layers[CorticalLayer.CONCEPTS].column_count()}\")",
        "   ```",
        "",
        "4. **Check parameters:**",
        "   - Default `cluster_strictness` in showcase.py",
        "   - Default embedding `method` and `dimensions`",
        "   - Any recent parameter changes",
        "",
        "**Evidence from showcase.py output:**",
        "```",
        "Layer 2: Concept Layer (V4)",
        "       3 minicolumns, 6 connections",
        "       Purpose: Semantic clusters",
        "",
        "Terms similar to 'neural':",
        "  â€¢ uniformly (similarity: 0.868)",
        "  â€¢ overcomes (similarity: 0.868)",
        "  â€¢ blockchain (similarity: 0.868)",
        "```",
        "",
        "**Acceptance Criteria:**",
        "- [ ] Root cause identified via git history",
        "- [ ] Concept clusters > 10 for 95-doc corpus",
        "- [ ] Embedding similarities semantically meaningful",
        "- [ ] Regression test added to prevent recurrence",
        "",
        "---",
        "",
        "| BugFix | 1 | Bug fixes and regressions |"
      ],
      "lines_removed": [],
      "context_before": [
        "4. **Skills documentation** - corpus-indexer skill explains metadata regeneration",
        "",
        "**Recommended workflow for new agents:**",
        "```bash",
        "# On arrival, check if metadata exists and regenerate if needed",
        "ls cortical/*.ai_meta || python scripts/generate_ai_metadata.py",
        "```",
        "",
        "---",
        ""
      ],
      "context_after": [
        "## Category Index",
        "",
        "| Category | Pending | Description |",
        "|----------|---------|-------------|",
        "| AINav | 6 | AI assistant navigation & usability |",
        "| DevEx | 6 | Developer experience (scripts, tools) |",
        "| Docs | 2 | Documentation improvements |",
        "| Arch | 4 | Architecture refactoring |",
        "| CodeQual | 3 | Code quality improvements |",
        "| Testing | 1 | Test coverage |",
        "| TaskMgmt | 2 | Task management system |",
        "| Deferred | 7 | Low priority or superseded |",
        "",
        "---"
      ],
      "change_type": "add"
    }
  ],
  "hour_of_day": 13,
  "day_of_week": "Thursday",
  "seconds_since_last_commit": -346268,
  "is_merge": false,
  "is_initial": false,
  "parent_count": 1,
  "session_id": null,
  "related_chats": [],
  "ci_result": null,
  "reverted": false,
  "amended": false
}