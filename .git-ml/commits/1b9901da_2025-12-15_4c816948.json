{
  "hash": "1b9901dafd67ef5925125a4a6cbf63ab89f0e578",
  "message": "fix: Correct line number assertions in pattern detection tests",
  "author": "Claude",
  "timestamp": "2025-12-15 02:47:07 +0000",
  "branch": "claude/multi-index-design-DvifZ",
  "files_changed": [
    "tests/unit/test_patterns.py"
  ],
  "insertions": 5,
  "deletions": 5,
  "hunks": [
    {
      "file": "tests/unit/test_patterns.py",
      "function": "async def fetch_data():",
      "start_line": 106,
      "lines_added": [
        "        assert 4 in patterns['generator']  # yield is on line 4 (after leading newline)"
      ],
      "lines_removed": [
        "        assert 3 in patterns['generator']  # yield is on line 3"
      ],
      "context_before": [
        "",
        "    def test_detect_generator(self):",
        "        \"\"\"Detect generator pattern.\"\"\"",
        "        code = \"\"\"",
        "def count_up(n):",
        "    for i in range(n):",
        "        yield i",
        "\"\"\"",
        "        patterns = detect_patterns_in_text(code)",
        "        assert 'generator' in patterns"
      ],
      "context_after": [
        "",
        "    def test_detect_singleton(self):",
        "        \"\"\"Detect singleton pattern.\"\"\"",
        "        code = \"\"\"",
        "class Singleton:",
        "    _instance = None",
        "",
        "    def __new__(cls):",
        "        if not hasattr(cls, '_instance'):",
        "            cls._instance = super().__new__(cls)"
      ],
      "change_type": "modify"
    },
    {
      "file": "tests/unit/test_patterns.py",
      "function": "class UserFactory:",
      "start_line": 148,
      "lines_added": [
        "        assert 3 in patterns['context_manager']  # __enter__ (line 3 after leading newline)",
        "        assert 6 in patterns['context_manager']  # __exit__ (line 6 after leading newline)"
      ],
      "lines_removed": [
        "        assert 2 in patterns['context_manager']  # __enter__",
        "        assert 5 in patterns['context_manager']  # __exit__"
      ],
      "context_before": [
        "        code = \"\"\"",
        "class FileManager:",
        "    def __enter__(self):",
        "        return self",
        "",
        "    def __exit__(self, exc_type, exc_val, exc_tb):",
        "        self.close()",
        "\"\"\"",
        "        patterns = detect_patterns_in_text(code)",
        "        assert 'context_manager' in patterns"
      ],
      "context_after": [
        "",
        "    def test_detect_decorator(self):",
        "        \"\"\"Detect decorator pattern.\"\"\"",
        "        code = \"\"\"",
        "@property",
        "def name(self):",
        "    return self._name",
        "",
        "@staticmethod",
        "def create():"
      ],
      "change_type": "modify"
    },
    {
      "file": "tests/unit/test_patterns.py",
      "function": "def create():",
      "start_line": 177,
      "lines_added": [
        "        assert 2 in patterns['error_handling']  # try (line 2 after leading newline)",
        "        assert 6 in patterns['error_handling']  # finally (line 6 after leading newline)"
      ],
      "lines_removed": [
        "        assert 1 in patterns['error_handling']  # try",
        "        assert 3 in patterns['error_handling']  # except"
      ],
      "context_before": [
        "        code = \"\"\"",
        "try:",
        "    risky_operation()",
        "except ValueError as e:",
        "    print(f\"Error: {e}\")",
        "finally:",
        "    cleanup()",
        "\"\"\"",
        "        patterns = detect_patterns_in_text(code)",
        "        assert 'error_handling' in patterns"
      ],
      "context_after": [
        "",
        "    def test_detect_custom_exception(self):",
        "        \"\"\"Detect custom exception pattern.\"\"\"",
        "        code = \"\"\"",
        "class ValidationError(Exception):",
        "    pass",
        "",
        "def validate(value):",
        "    if not value:",
        "        raise ValidationError(\"Invalid value\")"
      ],
      "change_type": "modify"
    }
  ],
  "hour_of_day": 2,
  "day_of_week": "Monday",
  "seconds_since_last_commit": -39461,
  "is_merge": false,
  "is_initial": false,
  "parent_count": 1,
  "session_id": null,
  "related_chats": [],
  "ci_result": null,
  "reverted": false,
  "amended": false
}