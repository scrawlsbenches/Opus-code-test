{
  "hash": "0d2448225695a98dd985ce06ea6f9a6976fb433b",
  "message": "Fix tests to not skip - provide sufficient data for concept clustering",
  "author": "Claude",
  "timestamp": "2025-12-10 05:48:14 +0000",
  "branch": "claude/multi-index-design-DvifZ",
  "files_changed": [
    "tests/test_processor.py"
  ],
  "insertions": 56,
  "deletions": 22,
  "hunks": [
    {
      "file": "tests/test_processor.py",
      "function": "class TestConceptConnections(unittest.TestCase):",
      "start_line": 1164,
      "lines_added": [
        "        # Create processor with documents that have NO overlap but enough content",
        "        # to form distinct concept clusters",
        "            \"doc1\",",
        "            \"Neural networks learn patterns from data using algorithms. \"",
        "            \"Deep learning models process information through layers. \"",
        "            \"Machine learning systems train on examples to improve accuracy.\"",
        "            \"doc2\",",
        "            \"Bread baking requires yeast and flour for fermentation. \"",
        "            \"Sourdough starters contain wild yeast and bacteria cultures. \"",
        "            \"Kneading dough develops gluten structure for texture.\"",
        "        processor.compute_all(verbose=False, build_concepts=False)",
        "        processor.build_concept_clusters(min_cluster_size=2, verbose=False)",
        "        self.assertGreaterEqual(layer2.column_count(), 2, \"Need at least 2 concepts\")"
      ],
      "lines_removed": [
        "        # Create processor with documents that have NO overlap",
        "            \"doc1\", \"Neural networks learn patterns from data using algorithms.\"",
        "            \"doc2\", \"Bread baking requires yeast and flour for fermentation.\"",
        "        processor.compute_all(verbose=False, build_concepts=True)",
        "        if layer2.column_count() < 2:",
        "            self.skipTest(\"Not enough concepts formed for this test\")"
      ],
      "context_before": [
        "        # The unrelated_doc about pottery should form isolated concepts",
        "        layer2 = self.processor.get_layer(CorticalLayer.CONCEPTS)",
        "",
        "        if layer2.column_count() > 0:",
        "            # At least some concepts should be isolated if topics are different",
        "            # This is a soft test since clustering may group differently",
        "            pass  # Concept isolation depends on clustering results",
        "",
        "    def test_concept_connections_zero_thresholds(self):",
        "        \"\"\"Test that min_shared_docs=0 and min_jaccard=0 allow all connections.\"\"\""
      ],
      "context_after": [
        "        processor = CorticalTextProcessor()",
        "        processor.process_document(",
        "        )",
        "        processor.process_document(",
        "        )",
        "",
        "        layer2 = processor.get_layer(CorticalLayer.CONCEPTS)",
        "",
        "        # Clear connections",
        "        for concept in layer2.minicolumns.values():",
        "            concept.lateral_connections.clear()",
        "",
        "        # With default thresholds, should get 0 connections (no doc overlap)",
        "        stats_default = processor.compute_concept_connections(verbose=False)",
        "",
        "        # Clear again",
        "        for concept in layer2.minicolumns.values():"
      ],
      "change_type": "modify"
    },
    {
      "file": "tests/test_processor.py",
      "function": "class TestConceptConnections(unittest.TestCase):",
      "start_line": 1207,
      "lines_added": [
        "            \"doc1\",",
        "            \"Dogs are animals that bark and run in parks. \"",
        "            \"Canines make loyal pets and companions for families. \"",
        "            \"Puppies require training and socialization early.\"",
        "            \"doc2\",",
        "            \"Cats are animals that meow and climb on furniture. \"",
        "            \"Felines are independent pets that groom themselves. \"",
        "            \"Kittens play with toys and explore their surroundings.\"",
        "        processor.process_document(",
        "            \"doc3\",",
        "            \"Quantum physics studies subatomic particle behavior. \"",
        "            \"Electrons orbit atomic nuclei in probability clouds. \"",
        "            \"Wave functions describe quantum mechanical states.\"",
        "        )",
        "        processor.compute_all(verbose=False, build_concepts=False)",
        "        processor.build_concept_clusters(min_cluster_size=2, verbose=False)",
        "        self.assertGreaterEqual(layer2.column_count(), 2, \"Need at least 2 concepts\")",
        "            \"doc1\",",
        "            \"Neural networks process information through layers. \"",
        "            \"Artificial intelligence learns patterns from training data. \"",
        "            \"Machine learning algorithms optimize model parameters.\"",
        "            \"doc2\",",
        "            \"Cooking recipes require specific ingredients and techniques. \"",
        "            \"Chefs prepare dishes using various culinary methods. \"",
        "            \"Kitchen equipment helps with food preparation tasks.\"",
        "        processor.compute_all(verbose=False, build_concepts=False)",
        "        processor.build_concept_clusters(min_cluster_size=2, verbose=False)",
        "        self.assertGreaterEqual(layer2.column_count(), 2, \"Need at least 2 concepts\")",
        "            \"doc1\",",
        "            \"Machine learning algorithms process data efficiently. \"",
        "            \"Neural networks train on large datasets to find patterns. \"",
        "            \"Supervised learning requires labeled training examples.\"",
        "            \"doc2\",",
        "            \"Ocean waves crash against rocky coastal shores. \"",
        "            \"Marine biology studies creatures living underwater. \"",
        "            \"Coral reefs provide habitat for diverse fish species.\"",
        "            \"doc3\",",
        "            \"Ancient history explores civilizations from the past. \"",
        "            \"Archaeological excavations uncover buried artifacts. \"",
        "            \"Museums preserve historical objects for education.\"",
        "        processor.compute_all(verbose=False, build_concepts=False)",
        "        processor.build_concept_clusters(min_cluster_size=2, verbose=False)",
        "        self.assertGreaterEqual(layer2.column_count(), 2, \"Need at least 2 concepts\")"
      ],
      "lines_removed": [
        "            \"doc1\", \"Dogs are animals. Dogs bark and run.\"",
        "            \"doc2\", \"Cats are animals. Cats meow and climb.\"",
        "        processor.compute_all(verbose=False, build_concepts=True)",
        "        if layer2.column_count() < 2:",
        "            self.skipTest(\"Not enough concepts formed for this test\")",
        "            \"doc1\", \"Neural networks process information through layers.\"",
        "            \"doc2\", \"Deep learning models use neural architectures.\"",
        "        processor.compute_all(verbose=False, build_concepts=True)",
        "        if layer2.column_count() < 2:",
        "            self.skipTest(\"Not enough concepts formed for this test\")",
        "            \"doc1\", \"Machine learning algorithms process data efficiently.\"",
        "            \"doc2\", \"Deep learning networks learn patterns from examples.\"",
        "            \"doc3\", \"Artificial intelligence uses machine learning methods.\"",
        "        processor.compute_all(verbose=False, build_concepts=True)",
        "        if layer2.column_count() < 2:",
        "            self.skipTest(\"Not enough concepts formed for this test\")"
      ],
      "context_before": [
        "        self.assertGreaterEqual(",
        "            stats_zero['connections_created'],",
        "            stats_default['connections_created']",
        "        )",
        "",
        "    def test_concept_connections_member_semantics(self):",
        "        \"\"\"Test that use_member_semantics creates connections via semantic relations.\"\"\"",
        "        processor = CorticalTextProcessor()",
        "        # Create documents with semantically related but non-overlapping content",
        "        processor.process_document("
      ],
      "context_after": [
        "        )",
        "        processor.process_document(",
        "        )",
        "        processor.extract_corpus_semantics(verbose=False)",
        "",
        "        layer2 = processor.get_layer(CorticalLayer.CONCEPTS)",
        "",
        "        # Clear connections",
        "        for concept in layer2.minicolumns.values():",
        "            concept.lateral_connections.clear()",
        "",
        "        # With member semantics enabled",
        "        stats = processor.compute_concept_connections(",
        "            use_member_semantics=True,",
        "            verbose=False",
        "        )",
        "",
        "        # Should have statistics for semantic connections",
        "        self.assertIn('semantic_connections', stats)",
        "        self.assertIn('doc_overlap_connections', stats)",
        "",
        "    def test_concept_connections_embedding_similarity(self):",
        "        \"\"\"Test that use_embedding_similarity creates connections via embeddings.\"\"\"",
        "        processor = CorticalTextProcessor()",
        "        processor.process_document(",
        "        )",
        "        processor.process_document(",
        "        )",
        "        processor.compute_graph_embeddings(verbose=False)",
        "",
        "        layer2 = processor.get_layer(CorticalLayer.CONCEPTS)",
        "",
        "        # Clear connections",
        "        for concept in layer2.minicolumns.values():",
        "            concept.lateral_connections.clear()",
        "",
        "        # With embedding similarity enabled",
        "        stats = processor.compute_concept_connections(",
        "            use_embedding_similarity=True,",
        "            embedding_threshold=0.1,  # Low threshold to catch similarities",
        "            verbose=False",
        "        )",
        "",
        "        # Should have statistics for embedding connections",
        "        self.assertIn('embedding_connections', stats)",
        "",
        "    def test_concept_connections_combined_strategies(self):",
        "        \"\"\"Test combining multiple connection strategies.\"\"\"",
        "        processor = CorticalTextProcessor()",
        "        processor.process_document(",
        "        )",
        "        processor.process_document(",
        "        )",
        "        processor.process_document(",
        "        )",
        "        processor.extract_corpus_semantics(verbose=False)",
        "        processor.compute_graph_embeddings(verbose=False)",
        "",
        "        layer2 = processor.get_layer(CorticalLayer.CONCEPTS)",
        "",
        "        # Clear connections",
        "        for concept in layer2.minicolumns.values():",
        "            concept.lateral_connections.clear()",
        "",
        "        # Enable all strategies",
        "        stats = processor.compute_concept_connections(",
        "            use_semantics=True,",
        "            use_member_semantics=True,",
        "            use_embedding_similarity=True,"
      ],
      "change_type": "modify"
    }
  ],
  "hour_of_day": 5,
  "day_of_week": "Wednesday",
  "seconds_since_last_commit": -460594,
  "is_merge": false,
  "is_initial": false,
  "parent_count": 1,
  "session_id": null,
  "related_chats": [],
  "ci_result": null,
  "reverted": false,
  "amended": false
}